# Copyright (c) 2015 Intracom S.A. Telecom Solutions. All rights reserved.
#
# This program and the accompanying materials are made available under the
# terms of the Eclipse Public License v1.0 which accompanies this distribution,
# and is available at http://www.eclipse.org/legal/epl-v10.html

# ------------------------------------------------------------------------------
# odlp_unit_test
# ------------------------------------------------------------------------------

- job-template:
    name: odlp_unit_test-{branch}
    description: 'Job runnning all unit-tests defined under util/unittests'
    block-downstream: false
    block-upstream: false
    defaults: gitlab-util
    triggers:
      - timed:
    builders:
      - python: |
           export PYTHONPATH=$WORKSPACE/
           pwd
           echo "Workspace:" $WORKSPACE
           echo "Job name:" $JOB_NAME
           cd $WORKSPACE
           cd util/unittests
           export TERM=xterm

           python3.4 -m unittest discover -vv -s ./ -p '*_test.py'

           cd $(dirname $WORKSPACE)
           rm -rf $JOB_NAME

# ------------------------------------------------------------------------------
# job instances
# ------------------------------------------------------------------------------

- project:
    name: odlp-util-jobs
    description: 'Enter the job description here'
    branch: develop_release_preparation_SONAR
    jobs:
        - 'odlp_unit_test-{branch}'